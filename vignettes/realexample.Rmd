---
title: "Approach in A Real Dataset"
author: "Selcen Ari"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Approach in A Real Dataset}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---


```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r, echo=FALSE, message= FALSE, warning=FALSE}
library(png)

```

# Description of the *huge_example* dataset?

Interactions between miRNAs and their targets can be analyzed after the integration of miRNA and targets via various datasets. As an example, we prepared the *huge_example* dataset. It was generated by integrating:

* Next-generation RNA sequencing data of a breast cancer patient from TCGA (patient id:TCGA_A7_A0CE) 
* High-throughput miRNA:target determination datasets. (#TODO can you give little bit detail about the source of data)

Below, only 6 rows from total of 26,176 rows are shown.

```{r, message=FALSE, warning=FALSE}
# install.packages("devtools")
# devtools::install_github("selcenari/ceRNAnetsim")
library(ceRNAnetsim)

data("huge_example")
head(huge_example)
```

## Select a node as trigger

The node that initiates simulation can be determined according your interest or research.

The dataset, which is a data frame, can be manipulated with [tidyverse packages](https://www.tidyverse.org/packages/). As an example, competing RNAs targeted by less than 5 miRNAs are eliminated to make the network manageable size.

> due to limitations of `priming_graph` function, the data frame should **not** be in tibble format, thus `as.data.frame()` might be used after manipulating the data frame.

```{r}
huge_example %>%
  add_count(competing) %>%
  filter(n > 5) %>%
  select(-n) %>% 
  as.data.frame()-> filtered_example

head(filtered_example)
```

On the other hand, we chose the node *GAPDH* according to interaction count of the nodes. With the simulation, the graph was visualized after node *GAPDH* was increased to five fold.

```{r, fig.height=5, fig.width=6, fig.align='center', warning=FALSE}
filtered_example %>%
  priming_graph(competing_count = competing_counts, 
                miRNA_count = mirnaexpression_normal, 
                aff_factor = Energy) %>%
  update_nodes(once = TRUE) %>%
  update_how("GAPDH", 5) %>%
  update_nodes() %>%
  vis_graph(title = "Distribution of GAPDH gene node")
```

Let's visualize each step of simulation via `simulate_vis()` function.

```{r, fig.height=5, fig.width=6, fig.align='center', warning=FALSE, fig.show='hide'}
filtered_example %>%
  priming_graph(competing_count = competing_counts, 
                miRNA_count = mirnaexpression_normal, 
                aff_factor = Energy) %>%
  update_nodes(once = TRUE) %>%
  update_how("GAPDH", 5) %>%
  update_nodes() %>%
  simulate_vis(title = "GAPDH over expression in the real dataset", 3)
```

![GAPDH over expression in real dataset](gifs/realexample.gif)

Now, we can track changes in expression levels at every node for 3 cycles when GAPDH is overexpressed 5-fold.

- In the first graph, the responses of the other competing elements to the GAPDH distributions were calculated. (#TODO didn't understand/observe this sentence, did you mean second graph instead of first graph: although the decreased expression level of GAPDH was determined.)

- The changing regulations (up or down) were observed as a result of interactions in the second graph.

- When three graphs were carefully compared to each other, it can be observed that the expression levels of nodes change continuously at each stage.
